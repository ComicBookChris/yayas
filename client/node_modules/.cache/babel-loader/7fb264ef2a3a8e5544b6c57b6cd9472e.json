{"ast":null,"code":"var _jsxFileName = \"C:\\\\e_commerce_project\\\\yayas\\\\client\\\\src\\\\components\\\\forms\\\\FileUpload.js\";\nimport React from 'react';\nimport Resizer from 'react-image-file-resizer';\nimport axios from 'axios';\nimport { useSelector } from 'react-redux';\nimport { Avatar, Badge } from 'antd';\n\nconst FileUpload = ({\n  values,\n  setValues,\n  setLoading\n}) => {\n  const {\n    user\n  } = useSelector(state => ({ ...state\n  }));\n\n  const fileUploadAndResize = e => {\n    // console.log(e.target.files);\n    // resize\n    let files = e.target.files;\n    let allUploadedFiles = values.images;\n\n    if (files) {\n      setLoading(true);\n\n      for (let i = 0; i < files.length; i++) {\n        Resizer.imageFileResizer(files[i], 720, 720, \"JPEG\", 100, 0, uri => {\n          // console.log(uri);\n          axios.post(`${process.env.REACT_APP_API}/uploadimages`, {\n            image: uri\n          }, {\n            headers: {\n              authtoken: user ? user.token : \"\"\n            }\n          }).then(res => {\n            console.log('IMAGE UPLOAD RES DATA', res);\n            setLoading(false);\n            allUploadedFiles.push(res.data);\n            setValues({ ...values,\n              images: allUploadedFiles\n            });\n          }).catch(err => {\n            setLoading(false);\n            console.log('CLOUDINARY UPLOAD ERROR', err);\n          });\n        }, 'base64');\n      }\n    } // send back to server to upload to cloudinary\n    // set url to images[] in the parent component - ProductCreate\n\n  };\n\n  const handleImageRemove = id => {\n    setLoading(true);\n    console.log(\"remove image\", id);\n    axios.post(`${process.env.REACT_APP_API}/removeimage`);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }, values.images && values.images.map(image => /*#__PURE__*/React.createElement(Badge, {\n    count: \"X\",\n    key: image.public_id,\n    onClick: () => handleImageRemove(image.public_id),\n    style: {\n      cursor: \"pointer\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    src: image.url,\n    size: 100,\n    shape: \"square\",\n    className: \"ml-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"btn btn-primary btn-raised\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, \"Choose File\", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    multiple: true,\n    hidden: true,\n    accept: \"images/*\",\n    onChange: fileUploadAndResize,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }))));\n};\n\nexport default FileUpload;","map":{"version":3,"sources":["C:/e_commerce_project/yayas/client/src/components/forms/FileUpload.js"],"names":["React","Resizer","axios","useSelector","Avatar","Badge","FileUpload","values","setValues","setLoading","user","state","fileUploadAndResize","e","files","target","allUploadedFiles","images","i","length","imageFileResizer","uri","post","process","env","REACT_APP_API","image","headers","authtoken","token","then","res","console","log","push","data","catch","err","handleImageRemove","id","map","public_id","cursor","url"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Resizer from 'react-image-file-resizer';\r\nimport axios from 'axios';\r\nimport { useSelector } from 'react-redux';\r\nimport { Avatar, Badge } from 'antd';\r\n\r\nconst FileUpload = ({ values, setValues, setLoading }) => {\r\n\r\n    const { user } = useSelector((state) => ({ ...state }));\r\n\r\n    const fileUploadAndResize = (e) => {\r\n        // console.log(e.target.files);\r\n        // resize\r\n        let files = e.target.files;\r\n\r\n        let allUploadedFiles = values.images;\r\n\r\n        if (files) {\r\n            setLoading(true);\r\n            for (let i = 0; i < files.length; i++) {\r\n                Resizer.imageFileResizer(\r\n                    files[i],\r\n                    720,\r\n                    720,\r\n                    \"JPEG\",\r\n                    100,\r\n                    0,\r\n                    (uri) => {\r\n                        // console.log(uri);\r\n                        axios.post(\r\n                            `${process.env.REACT_APP_API}/uploadimages`,\r\n                            { image: uri },\r\n                            {\r\n                                headers: {\r\n                                    authtoken: user ? user.token : \"\",\r\n                                }\r\n                            }\r\n                        )\r\n                            .then(res => {\r\n                                console.log('IMAGE UPLOAD RES DATA', res);\r\n                                setLoading(false);\r\n                                allUploadedFiles.push(res.data);\r\n\r\n                                setValues({ ...values, images: allUploadedFiles });\r\n                            })\r\n                            .catch(err => {\r\n                                setLoading(false);\r\n                                console.log('CLOUDINARY UPLOAD ERROR', err);\r\n                            });\r\n                    },\r\n                    'base64'\r\n                );\r\n            }\r\n        }\r\n        // send back to server to upload to cloudinary\r\n        // set url to images[] in the parent component - ProductCreate\r\n    };\r\n\r\n    const handleImageRemove = (id) => {\r\n        setLoading(true);\r\n        console.log(\"remove image\", id);\r\n        axios.post(`${process.env.REACT_APP_API}/removeimage`)\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"row\">\r\n                {values.images && values.images.map((image) => (\r\n                    <Badge\r\n                        count=\"X\"\r\n                        key={image.public_id}\r\n                        onClick={() => handleImageRemove(image.public_id)}\r\n                        style={{cursor: \"pointer\"}}\r\n                    >\r\n                        <Avatar\r\n\r\n                            src={image.url}\r\n                            size={100}\r\n                            shape=\"square\"\r\n                            className=\"ml-3\"\r\n                        />\r\n                    </Badge>\r\n                ))}\r\n            </div>\r\n            <div className=\"row\">\r\n                <label className=\"btn btn-primary btn-raised\">\r\n                    Choose File\r\n            <input\r\n                        type=\"file\"\r\n                        multiple\r\n                        hidden\r\n                        accept=\"images/*\"\r\n                        onChange={fileUploadAndResize}\r\n                    />\r\n                </label>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default FileUpload;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}